<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- GOOGLE FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/cadastro5.css">
    <link rel="stylesheet" href="/css/navbar.css">
    <title>SGA - Cadastro</title>
</head>

<body>
    <!-- CABEÇALHO -->
    <!---------------NAVBAR-------------------------------------------------->
    <div class="navbar-caixa">
        <div class="conteudo-nav">
            <div class="texto-nav">Cadastrar Novo Item</div>

            <button id="menu-btn" class="menu-btn">&#9776;</button>
        </div>

        <!--------------------------------HAMBURGUER------------------------------------------------------------------------------------>
        <div id="sidebar" class="sidebar">
            <button id="close-btn" class="close-btn">&times;</button>
            <img src="/imglogineusuario/senaibranco.svg" alt="" />
            <h3>Menu</h3>
            <ul>


                <li class="home">
                    <a href="/telaInicial.html" id="home">
                        <div class="home"></div>
                        <span>Home</span>
                    </a>
                </li>


                <li class="cadastrar">
                    <a href="cadastro1" id="cadas">
                        <div class="box-of-good-good"></div>
                        <span>Cadastrar</span>
                    </a>
                </li>


                <li class="edicao">
                    <a href="/edicao.html" id="edicao">
                        <div class="pencil"></div>
                        <span>Edição</span>
                    </a>
                </li>


                <li class="estoque-item">
                    <a href="#" id="esto" class="estoque-link">
                        <div class="boxes-of-good-good"></div>
                        <span>Estoque</span>
                    </a>
                    <ul id="estoque-submenu" class="submenu">
                        <li><a href="/catalogo.html">Catálogo</a></li>
                        <li><a href="/estoque_real.html">Estoque Real e Inventário</a></li>
                        <li><a href="/layout.html">Layout do Estoque</a></li>
                    </ul>
                </li>


                <li class="financeiro">
                    <a href="/financeiro.html" id="finan">
                        <div class="financial"></div>
                        <span>Financeiro</span>
                    </a>
                </li>
            </ul>

            <div class="container-logos">
                <h4>SGA - Sistema de Gerenciamento de Armazém</h4>
                <img src="/imagens/logo-emp.svg" id="logo-gato" alt="" /><img src="/imagens/logo-soft.svg"
                    id="logo-cubo" />
            </div>
        </div>
    </div>
    <!-------------------------------------------------------------------------------------------------------------------------------->

    <section class="cadastro">
        <div class="flex">
            <!-- ESQUERDA -->
            <div class="parte-bolinhas">
                <div class="container">
                    <div class="bolinha1"></div>
                    <div class="palitinho1"></div>
                    <div class="bolinha2"></div>
                    <div class="palitinho2"></div>
                    <div class="bolinha3"></div>
                    <div class="palitinho3"></div>
                    <div class="bolinha4"></div>
                    <div class="palitinho4"></div>
                    <div class="bolinha5"></div>
                    <ul>
                        <li>Informações Básicas</li>
                        <li>Informações de Entrada</li>
                        <li>Categoria</li>
                        <li>Especificações</li>
                        <li>Adicional</li>
                    </ul>
                </div>
                <div class="caixa-aberta">
                    <img src="/imgCADASTRO/CaixaFechada.svg" alt="">
                </div>
            </div>

            <!-- DIREITA -->
            <div class="inserir-info">
                <div class="container">
                    <div class="porcentagem-linha">
                        <div class="linha-verde"></div>
                    </div>

                    <p>100%</p>
                    <div class="divisoria"></div>

                    <!-- FORMULÁRIO -->
                    <form id="formAdicionarProduto" action="/cadastro/cadastro5" method="POST" enctype="multipart/form-data">
                        <div class="Adicional">
                            <h1>Adicional</h1>
                            <div class="imagem">
                                <div class="image-upload">
                                    <label for="image-input">Imagem</label>
                                    <input type="file" id="image-input" name="imagem" accept="image/*" >
                                    <img id="uploaded-image" src="" alt="Uploaded Image">
                                </div>
                            </div>
                            <div class="caixaTexto">
                                <textarea style="resize: none" id="observacao" name="observacao" placeholder="Observação Adicional" required></textarea>
                            </div>
                        </div>

                        <div class="setas">
                            <button type="button" id="esquerda" onclick="location.href='cadastro4';">
                                <img src="/imgCADASTRO/setaESQUERDA.svg" alt="">
                            </button>
                        </div>
                        <div class="salvar">
                            <button type="submit" id="salvar">SALVAR</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="footer">
            <img src="/imgCADASTRO/gatinhoRodapé.svg" alt="">
        </div>
    </section>

    <!-- SCRIPT -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {

            const estoqueItem = document.querySelector('.estoque-item');
            const estoqueSubMenu = document.getElementById('estoque-submenu');
            const estoqueLink = document.getElementById('esto');
            const iconeEstoque = estoqueLink.querySelector('.boxes-of-good-good');

            const submenuLinks = estoqueSubMenu.querySelectorAll('a');
            submenuLinks.forEach(link => {
                link.addEventListener('click', function (event) {
                    event.stopPropagation();
                });
            });

            estoqueItem.addEventListener('click', function (event) {
                event.preventDefault();

                estoqueItem.classList.toggle('active');
                if (estoqueItem.classList.contains('active')) {
                    estoqueSubMenu.style.display = "block";
                    estoqueItem.style.backgroundColor = "#000";
                    estoqueLink.style.color = "#319DF6";
                    iconeEstoque.style.backgroundImage = "url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cpath fill='%23319df6' d='M10 4v11h12V4zm2 2h2v4l2-2l2 2V6h2v7h-8zM3 17v11h12V17zm14 0v11h12V17zM5 19h2v4l2-2l2 2v-4h2v7H5zm14 0h2v4l2-2l2 2v-4h2v7h-8z'/%3E%3C/svg%3E\")";
                } else {
                    estoqueSubMenu.style.display = "none";
                    estoqueItem.style.backgroundColor = "";
                    estoqueLink.style.color = "";
                    iconeEstoque.style.backgroundImage = "";
                }
            });

            // Fecha o dropdown ao clicar fora
            document.addEventListener('click', function (event) {
                if (!estoqueItem.contains(event.target)) {
                    estoqueItem.classList.remove('active');
                    estoqueSubMenu.style.display = "none";
                    estoqueItem.style.backgroundColor = "";
                    estoqueLink.style.color = "";
                    iconeEstoque.style.backgroundImage = "";
                }
            });


        });


     
    
          document.querySelector('form').addEventListener('submit', async (event) => {
            event.preventDefault(); // Impede o envio padrão do formulário
        
            const formData = new FormData(event.target);
        
            try {
              const response = await fetch(event.target.action, {
                method: 'POST',
                body: formData
              });
        
              const result = await response.json();
        
              if (result.success) {
                Swal.fire({
                    icon: 'success',
                    title: 'Sucesso!',
                    text: result.message,
                    timer: 1000, // Fecha automaticamente após 1 segundo
                    showConfirmButton: false // Remove o botão de confirmação
                  }).then(() => {
                    if (result.usuario && result.usuario.tipo === 'professor') {
                      localStorage.setItem('SNProfessor', result.usuario.SN);
                      location.href = "/telaInicial-Professor.html";
                    } else {
                      location.href = "/telaInicial.html";
                    }
                });
              } else {
                Swal.fire({
                  icon: 'error',
                  title: 'Erro!',
                  text: result.error || 'Ocorreu um erro desconhecido.',
                });
              }
            } catch (error) {
              console.error('Erro:', error);
              Swal.fire({
                icon: 'error',
                title: 'Erro!',
                text: 'Erro ao enviar o formulário.',
              });
            }
          });
        </script>
        

    <script src="/js/cadastro5.js"></script>
    <script src="/js/navbar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>